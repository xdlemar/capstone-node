generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum DocStatus {
  DRAFT
  IN_REVIEW
  RELEASED
  ARCHIVED
}

model Document {
  id          BigInt        @id @default(autoincrement())
  docNo       String        @unique
  title       String
  category    String?
  status      DocStatus     @default(DRAFT)
  ownerDept   String?
  relatedPoId BigInt?
  relatedGrnId BigInt?
  moves       DocumentMove[]
  createdAt   DateTime      @default(now())

  @@map("documents")
}

model DocumentMove {
  id     BigInt   @id @default(autoincrement())
  docId  BigInt
  doc    Document @relation(fields: [docId], references: [id], onDelete: Cascade)
  action String
  from   String?
  to     String?
  at     DateTime @default(now())
  by     String?

  @@map("document_moves")
  @@index([docId])
}
